id,severity,category,file,path,line,description,suggestion
1,High,Privilege Escalation,backend/server.py,backend/server.py,288-320,Public `register` endpoint accepts `role` allowing creation of admin/super_admin accounts,Restrict public registration to low-privilege roles (e.g., force `INWARD_USER`) or require invitation/approval for admin creation
2,High,Security,CORS misconfiguration,backend/server.py,929-937,Uses `allow_credentials=True` with `allow_origins='*'` which is invalid and insecure,Require explicit origin list when `allow_credentials=True`; do not use `'*'` with credentials or set `allow_credentials=False` for wildcard
3,High,Auth/Cookie,backend/server.py,432-441,Sets cookie with `secure=True` and `samesite='none'`, blocking cookies on non-HTTPS/dev (localhost),Make `secure` conditional (only in prod/HTTPS) or detect localhost and set `secure=False` during development
4,High,Frontend Authorization,frontend/src/pages/LoginPage.js,frontend/src/pages/LoginPage.js,21-55,Registration UI includes `role` and posts to `/auth/register` enabling client-side elevation,Remove `role` from public registration UI and enforce server-side allowed role for public registration
5,Critical,Default Credentials,backend/server.py,936-964,Creates a default super admin with hardcoded password and logs credentials at startup,Do not create default super admin with predictable password; require env-provided admin creds or generate and surface securely, avoid logging plaintext credentials
6,Medium,Config/Hardcoding,backend/server.py,400-444,Hardcoded external auth URL (`demobackend.emergentagent.com`) with comment warning about it; brittle and not configurable,Move external auth URL to env/config and add robust error handling; avoid hardcoding production endpoints
7,Medium,Validation,backend/server.py,741-780 & 800-880,No positive-value validation for `inward_qty`, `inward_rate`, or `issued_qty` allowing negative/zero values,Validate numeric inputs (>=0 or >0 as appropriate) and return 400 for invalid values
8,Medium,Env Safety,backend/server.py,18-38,Uses `os.environ['MONGO_URL']` (KeyError if missing) and default weak `SECRET_KEY`,Fail fast with clear error if critical env vars missing; require strong `SECRET_KEY` in production and refuse to start or log warnings
9,Medium,Frontend Config,frontend/src/utils/api.js,frontend/src/utils/api.js,1-6,`BACKEND_URL` may be undefined leading to `undefined/api` baseURL and broken requests,Provide a sensible default or throw a clear error when `REACT_APP_BACKEND_URL` is missing; document required env var
10,Low,Memory Leak,frontend/src/hooks/use-toast.js,frontend/src/hooks/use-toast.js,138,`useEffect` uses `[state]` dependency causing repeated listener registration and potential memory leaks,Change dependency array to `[]` so listener is added once; ensure cleanup removes the registered listener correctly
